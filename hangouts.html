<script type="text/javascript">
  RED.nodes.registerType("hangouts-config", {
    category: "config",
    defaults: {
      name: {value:"", required: false},
      token: {value:"", required: true},
      debug: {value:false, required: true}
    },
    credentials: {
      cookiestore: {type: "password"}
    },
    label: function() {
      return this.name ? this.name : "Hangouts Config";
    }
  });
</script>

<script type="text/x-red" data-template-name="hangouts-config">
    <div class="form-tips">
      To login, you need to login using OAuth and provide the access token to the API. The API will shows up as "iOS Device" in your accounts page.

      This is the login URL:
      <a target="_blank" href="https://accounts.google.com/o/oauth2/auth?&client_id=936475272427.apps.googleusercontent.com&scope=https%3A%2F%2Fwww.google.com%2Faccounts%2FOAuthLogin&redirect_uri=urn%3Aietf%3Awg%3Aoauth%3A2.0%3Aoob&response_type=code">OAuth Link</a>
    </div>
    <div class="form-row">
        <label for="node-config-input-name"><i class="icon-bookmark"></i>Name</label>
        <input type="text" id="node-config-input-name" />
    </div>
    <div class="form-row">
        <label for="node-config-input-token"><i class="icon-bookmark"></i>Token</label>
        <input type="text" id="node-config-input-token" />
    </div>
    <div class="form-row">
      <label>&nbsp;</label>
      <input type="checkbox" id="node-config-input-debug" placeholder="" style="display: inline-block; width: auto; vertical-align: top;">
      <label for="node-config-input-debug" style="width: 70%;">Debug mode</label>
    </div>
</script>

<script type="text/javascript">
  RED.nodes.registerType("hangouts-in", {
    category: "input",
    color: "#7bc54a",
    icon: "hangouts.png",
    defaults: {
      config: {type:"hangouts-config",required:true},
      name: {value:"", required: false},
      topic: { value:"", required: false},
      senders: { value:"", required: false},
      suppress: {value:true, required: true}
    },
    inputs:0,
    outputs:1,
    label: function() {
      return this.name ? this.name : "Hangouts";
    }
  });
</script>

<script type="text/x-red" data-template-name="hangouts-in">
    <div class="form-row">
        <label for="node-input-config"><i class="fa fa-user"></i>Config</label>
        <input type="text" id="node-input-config">
    </div>
    <div class="form-row">
        <label for="node-input-name"><i class="icon-bookmark"></i>Name</label>
        <input type="text" id="node-input-name" />
    </div>
    <div class="form-row">
        <label for="node-input-topic"><i class="icon-bookmark"></i>Topic</label>
        <input type="text" id="node-input-topic" />
    </div>
    <div class="form-row">
        <label for="node-input-senders"><i class="icon-bookmark"></i>Senders</label>
        <input type="text" id="node-input-senders" />
    </div>
    <div class="form-row">
      <label>&nbsp;</label>
      <input type="checkbox" id="node-input-suppress" placeholder="" style="display: inline-block; width: auto; vertical-align: top;">
      <label for="node-input-suppress" style="width: 70%;">Suppress own messages</label>
    </div>
</script>

<script type="text/x-red" data-help-name="hangouts-in">
   <p>Receive messages from Google hangouts</p>
   <p>The input node is used to receive messages from the hangouts network. You can use the senders field to filter incoming messages by sender. If the field is empty, all messages are accepted. You can use multiple contacts by separating them with a comma. Make sure to use valid and registered emails and make sure that both accounts have accepted the hangout invitation. The message contains the message in <b>msg.payload</b>, the contact information in <b>msg.sender</b> and the complete message event object in <b>msg.event</b>.</p>
</script>


<script type="text/javascript">
  RED.nodes.registerType("hangouts-out", {
    category: "output",
    color: "#7bc54a",
    icon: "hangouts.png",
    defaults: {
      config: {type:"hangouts-config",required:true},
      name: {value:"", required: false},
      recipients: {value:"", required: false}

    },
    inputs:1,
    outputs:0,
    label: function() {
      return this.name ? this.name : "Hangouts";
    }
  });
</script>

<script type="text/x-red" data-template-name="hangouts-out">
    <div class="form-row">
        <label for="node-input-config"><i class="fa fa-user"></i>Config</label>
        <input type="text" id="node-input-config">
    </div>
    <div class="form-row">
        <label for="node-input-name"><i class="icon-bookmark"></i>Name</label>
        <input type="text" id="node-input-name" />
    </div>
    <div class="form-row">
        <label for="node-input-recipients"><i class="icon-bookmark"></i>Recipients</label>
        <input type="text" id="node-input-recipients" />
    </div>
</script>

<script type="text/x-red" data-help-name="hangouts-out">
   <p>Receive messages from Google hangouts</p>
   <p>The output node is used to send messages to one or multiple contacts. You can use the recipients field or by providing a array to <b>msg.recipients</b> to define the recipients. If you have multiple contacts in one node, a group chat will be initialized. Use multiple nodes to create separated conversations. The <b>msg.payload</b> will be send to the contacts.</p>
</script>
